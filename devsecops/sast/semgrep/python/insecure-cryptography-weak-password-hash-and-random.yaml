rules:
  - id: python-insecure-cryptography-password-hash-and-random
    languages: [python]
    message: >
      Insecure cryptography usage. MD5/SHA1 for passwords
      or non-cryptographic random for security token.
    severity: ERROR
    metadata:
      category: security
      cwe: "CWE-327"
      owasp: "A02:2021-Cryptographic Failures"
    patterns:
      - pattern-either:
          - pattern: hashlib.md5(...)
          - pattern: hashlib.sha1(...)
          - pattern: random.random(...)
          - pattern: random.choice(...)
      - pattern-not: bcrypt
      - pattern-not: argon2
      - pattern-not: secrets