rules:
  - id: python-hardcoded-secret-and-debug-enabled
    languages: [python]
    message: >
      Possible hardcoded secret or debug mode enabled.
      Secrets should not be in source code.
    severity: ERROR
    metadata:
      category: security
      cwe: "CWE-798"
      owasp: "A02:2021-Cryptographic Failures"
    patterns:
      - pattern-either:
          - pattern: $VAR = "sk_$X"
          - pattern: $VAR = "AKIA$X"
          - pattern: $VAR = "-----BEGIN PRIVATE KEY-----..."
          - pattern: $VAR = "$SECRET"
          - pattern: app.run(..., debug=True)
      - pattern-not: os.environ.get(...)